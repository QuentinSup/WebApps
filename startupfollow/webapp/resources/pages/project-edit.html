<link rel="stylesheet" href="{$host}assets/css/simpleupload.css" type="text/css" media="all" />
<!-- Header -->
<header id="header" class="navigation-bar-header light hidden-xs">
	<div class="container">
		<nav class="navigation">
			<div class="navigation-txt visible-xs" data-toggle="dropdown">Home</div>
			<button class="navigation-toggle visible-xs" type="button" data-toggle="dropdown">
				<span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
			</button>
			<div class="col-sm-1">
				<!-- ko with: startup() -->
				<a class="menu clickable">
					<img data-bind="attr: { 'src': $data.image || host + 'assets/img/avatars/project-avatar.svg' }" class="img-responsive img-circle" alt="startup" />
					<ul>
						<li data-bind="click: function() { document.location.href = host + 'follow/' + ref }" class="clickable"><span class="fa fa-flask"></span>&nbsp;Voir la page</li>
					</ul>
				</a>
				<!-- /ko -->
			</div>
			<div class="col-sm-10">
				<ul class="navigation-bar navigation-bar-left">
					<li>
						
					</li>
				</ul>
			</div>
			<div class="col-sm-1 text-right">
				<!-- ko if: user.data() -->
				<div class="col-sm-12">
					<a href="{$host}account" class="menu right">
						<img data-bind="attr: { 'src': user.data().image || host + 'assets/img/avatars/user-avatar.png' }" class="img-responsive img-circle" alt="user" />
						<ul>
							<li data-bind="click: function() { document.location.href = host + 'account' }" class="clickable"><span class="fa fa-gear"></span>&nbsp;Paramètre du compte</li>
							<li data-bind="click: function() { user.logout() }" class="clickable"><span class="fa fa-power-off"></span>&nbsp;Déconnexion</li>
						</ul>
					</a>
				</div>
				<!-- /ko -->
			</div>
		</nav>
	</div>
</header>
<!-- End Header -->
<section style="font-size: .9em; padding-top: 2em;" class="bg-gray">
	<div class="container">
		<div class="row">
			<div class="col-sm-3">
				<ul class="list">
					<li class="clickable" data-bind="click: function() { showSection(1) }, css: { 'strong': index() == 1 }">Votre Startup</li>
					<li class="clickable" data-bind="click: function() { showSection(2) }, css: { 'strong': index() == 2 }">Logo &amp; réseaux sociaux</li>
					<li class="clickable" data-bind="click: function() { showSection(3) }, css: { 'strong': index() == 3 }">Votre équipe</li>
					<li class="clickable" data-bind="click: function() { showSection(4) }, css: { 'strong': index() == 4 }">Vos récits</li>
					<li class="clickable" data-bind="click: function() { showSection(5) }, css: { 'strong': index() == 5 }">Les événements</li>
				</ul>
			</div>
			<div class="col-sm-9">
				<div id="sections" class="slider" data-slider-speed="0">
					<ul>
						<li>
							<section class="content">
								<div class="h8">Votre Startup</div>
								<!-- ko with: form -->
								<form data-role="form">
									<div class="form-group row has-feedback">
										<label for="FormInputName" class="col-sm-12 control-label">Nom et phrase d'accroche</label>
										<div class="col-sm-4">
											<input id="FormInputName" type="text" value="" class="form-control" data-bind="value: name, valueUpdate: 'input'"
												placeholder="nom du projet..." required />
											<!-- ko if: isCheckingNameExists() -->
											<img src="{$host}/assets/img/preloader.gif" class="form-control-feedback" aria-hidden="true" />
											<!-- /ko -->
											<!-- ko if: !isCheckingNameExists() && !nameExists() -->
											<span class="glyphicon glyphicon-ok form-control-feedback check" aria-hidden="true"></span>
											<!-- /ko -->
										</div>
									</div>
									<div class="form-group row">
										<div class="col-sm-8">
											<input id="FormInputPunchLine" type="text" class="form-control" value="" data-bind="value: punchLine, valueUpdate: 'input'"
												placeholder="Ex. : In tartiflette we trust" />
										</div>
									</div>

									<div class="form-group row">
										<div class="col-sm-12">
											<label for="FormInputEmail" class="control-label">Adresse de contact</label>
											<p class="help-block">Cette adresse sera privilégiée pour prendre contact avec vous et votre équipe. Vous recevrez une notification afin de donner
												régulièrement des nouvelles à votre communauté</p>
										</div>
										<div class="col-sm-8">
											<input id="FormInputEmail" type="text" class="form-control" value="" data-bind="value: email, valueUpdate: 'input'"
												placeholder="email de contact" required />
										</div>
									</div>
									
									<div class="form-group row">
										<label for="FormInputEmail" class="control-label">Début du projet</label>
										<p class="help-block">Quand avez-vous commencé le projet ?</p>
										<div class="form-group col-sm-3">
											<select class="form-control" data-bind="value: month, valueUpdate: 'input'" placeholder="Sélectionner le mois" required>
												<option value="1">Janvier</option>
												<option value="2">Février</option>
												<option value="3">Mars</option>
												<option value="4">Avril</option>
												<option value="5">Mai</option>
												<option value="6">Juin</option>
												<option value="7">Juillet</option>
												<option value="8">Août</option>
												<option value="9">Septembre</option>
												<option value="10">Octobre</option>
												<option value="11">Novembre</option>
												<option value="12">Décembre</option>
											</select>
										</div>
										<div class="form-group col-sm-2 col-sm-offset-1">
											<input type="text" class="form-control text-center" data-bind="value: year, valueUpdate: 'input'" placeholder="année" maxlength="4" required />
										</div>
									</div>
									
									<div class="form-submit">
										<button data-bind="disable: isCheckingNameExists() || nameExists() || !isValidDate() || !isEmailValid(), click: function() { submit(); }" class="btn btn-default">Enregistrer</button>
									</div>
								</form>
								<!-- /ko -->
							</section>
						</li>
						<li>
							<section class="content">
								<div class="h8">Votre logo</div>
								<p>Votre logo et vos liens vers vos réseaux sociaux permettront à vos fans de vous suivre plus facilement et d'accroître votre communauté.</p>
								<!-- ko with: form -->
								<form class="form-register" data-role="form">
									<label>Votre image</label>
									
									<div class="form-group row">
										<div class="col-sm-12 text-center">
											<div id="fileuploader">
												<img id="fileuploader-preview" data-bind="attr: { 'src': $data.image }" />
												<div class="upload-bar">
													<div id="fileupload-pbar"></div>
												</div>
											</div>
											<p class="help-block">Fichiers autorisés : .png, .jpg. Max: 3Mb</p>
										</div>
									</div>
									<label>Liens</label>
									<div class="form-group row-fluid">
										<div class="input-group col-sm-4">
											<span class="input-group-addon"><span class="fa fa-twitter"></span></span> <input type="text" class="form-control" value=""
												data-bind="value: twitter, valueUpdate: 'input'" placeholder="@" />
										</div>
									</div>
									<div class="form-group row-fluid">
										<div class="input-group col-sm-6">
											<span class="input-group-addon"><span class="fa fa-link"></span></span> <input type="text" class="form-control" value=""
												data-bind="value: website, valueUpdate: 'input'" placeholder="http://" />
										</div>
									</div>
									<div class="form-group row-fluid">
										<div class="input-group col-sm-6">
											<span class="input-group-addon"><span class="fa fa-facebook"></span></span> <input type="text" class="form-control" value=""
												data-bind="value: facebook, valueUpdate: 'input'" placeholder="" />
										</div>
									</div>
									<div class="form-submit">
										<button data-bind="click: function() { submit(); }" class="btn btn-default">Enregistrer</button>
									</div>
								</form>
								<!-- /ko -->
							</section>
						</li>
						<li>
							<section class="content">
								<div class="h8">Votre équipe</div>
								<p></p>
								<!-- ko with: form -->
								<form data-role="form" class="form">
									<label>Votre équipe</label>
									<p>Invitez votre équipe à vous rejoindre !</p>
									<!-- ko foreach: members() -->
									<!-- ko ifnot: deleted() -->
									<div class="row">
										<div class="col-sm-1">
											<button class="btn" data-bind="click: function() { $parent.removeMember($index()); }">-</button>
										</div>
										<!-- ko if: !!$data.user() -->
										<div class="col-sm-2 text-center">
											<div class="img-wrapper">
												<img data-bind="attr: { 'src': $data.user().image || host + 'assets/img/avatars/team-avatar.png' }" class="img-responsive img-circle small" alt="avatar" />
											</div>
										</div>
										<div class="col-sm-4">
											<label>
											<span data-bind="text: $data.user().name"></span>
											<br />
											<!-- ko if: joined() -->
											<strong>accepté</strong>
											<!-- /ko -->
											<!-- ko ifnot: joined() -->
											<!-- ko if: !$data.invitationSentAt() -->
											<strong>nouveau</strong>
											<!-- /ko -->
											<!-- ko if: $data.invitationSentAt() -->
											<strong data-bind="attr: { 'title': 'Invitation envoyée le ' + $data.invitationSentAt() }">invitation en attente</strong>
											<!-- /ko -->
											<!-- /ko -->
											</label>
										</div>
										<!-- /ko -->
										<!-- ko ifnot: !!$data.user() -->
										<div class="col-sm-2 text-center">
											<div class="img-wrapper">
												<img src="{$host}assets/img/avatars/team-avatar.png" class="img-responsive img-circle small" alt="avatar" />
											</div>
										</div>
										<div class="col-sm-4">
											<!-- ko if: !$data.invitationSentAt() -->
											<input type="text" class="form-control" value="" data-bind="value: email, valueUpdate: 'input', disable: !!$data.uid(), attr: { 'title': $data.invitationSentAt()?'Invitation envoyée le ' + $data.invitationSentAt():'' }" placeholder="Email" required />
											<!-- /ko -->
											<!-- ko if: $data.invitationSentAt() -->
											<label>
											<span data-bind="text: $data.email()"></span>
											<br />
											<strong>invitation en attente</strong>
											</label>
											<!-- /ko -->
										</div>
										<!-- /ko -->
										<div class="col-sm-3">
											<div class="form-group">
												<input type="text" class="form-control" value="" data-bind="value: role, valueUpdate: 'input'" placeholder="Rôle" />
											</div>
										</div>
									</div>
									<!-- /ko -->
									<!-- /ko -->
									<div class="form-group">
										<button data-bind="click: function() { addMember(); }" class="btn col-sm-1">+</button>
									</div>
									<div class="form-submit">
										<button data-bind="click: function() { submit(); }" class="btn btn-default">Enregistrer</button>
									</div>
								</form>
								<!-- /ko -->
							</section>
						</li>
						<li>
							<section class="content">
								<div class="h8">Vos récits</div>
								<button data-bind="click: function() { newStory(); }" class="btn white">Ajouter</button>
								<div id="stories" class="slider">
									<ul>
										<li>
											<ul class="list">
												<hr />
												<!-- ko if: stories().length == 0 --><li>
												<div class="h7">
												<p>Il est temps de donner de vos nouvelles !</p>
												<span class ="fa fa-hand-o-right"></span>&nbsp;<strong><a class="clickable" data-bind="click: function() { newStory(); }">C'est parti !</a></strong></div>
												<!-- /ko -->
												<!-- ko foreach: stories -->
												<li>
													<div class="row">
														<div class="col-sm-10 clickable" data-bind="click: function() { $root.editStory($data.uid) }">
															<strong data-bind="text: $data.shortLine"></strong><br />
															<time class="timeago" data-bind="attr: { 'datetime' : $data.date }"></time>
														</div>
														<div class="col-sm-2 text-right">
															<!-- ko if: $data.visibility == '1' -->
															<span data-bind="click: function() { $root.updateStorySettings($data.uid, { visibility: '0' }); }" title="Le récit est visible. Cliquer pour le rendre invisible" class="clickable fa fa-eye"></span>
															<!-- /ko -->
															<!-- ko ifnot: $data.visibility == '1' -->
															<span data-bind="click: function() { $root.updateStorySettings($data.uid, { visibility: '1' }); }" title="Le récit n'est pas visible. Cliquer pour le rendre visible" class="clickable fa fa-eye-slash"></span>
															<!-- /ko -->
															<!-- ko if: !!$data.sharedAt -->
															<span title="Le récit a été partagé" class="fa fa-check"></span>
															<!-- /ko -->
															<!-- ko ifnot: !!$data.sharedAt -->
															<span data-bind="click: function() { $root.shareStory($data.uid); }" title="Le récit va être partagé prochainement. Cliquer pour partager le récit immédiatement" class="clickable fa fa-share"></span>
															<!-- /ko -->
														</div>
													</div>
												</li>
												<!-- /ko -->
											</ul>
										</li>
										<li class="content">
											<!-- ko with: storyform -->
											<form data-role="form">
												<label></label>
												<div class="row">
													<div class="form-group col-sm-12">
														<input type="text" class="form-control h7" value="" data-bind="value: shortLine, valueUpdate: 'input'"
															placeholder="Ex. : Startup Weekend nous voilà !" required />
													</div>
												</div>
												<div class="row">
													<div class="form-group col-sm-12">
														<div id="form-text" data-bind="html: text" class="tinymce" title="Donnez à vos fans l'envie de vous suivre !"
															placeholder="Donnez de vos nouvelles à vos fans !"></div>
													</div>
												</div>
												<div class="form-submit">
													<button data-bind="click: function() { cancel(); }" class="btn blank">Annuler</button>
													<button data-bind="click: function() { submit(); }" class="btn btn-default">Enregistrer</button>
												</div>
											</form> <!-- /ko -->
										</li>
									</ul>
								</div>
							</section>
						</li>
						<li>
							<section id="events" class="content">
								<div class="h8">Historique</div>
								<ul class="list">
								<!-- ko foreach: events() -->
									<!-- ko if: $data.type == 1 -->
									<li>
										<time data-bind="attr: { 'datetime': $data.date }" class="timeago"></time>Création du compte par <strong data-bind="text: $data.user.name"></strong>
									</li>
									<!-- /ko -->
									<!-- ko if: $data.type == 2 -->
									<li>
										<time data-bind="attr: { 'datetime': $data.date }" class="timeago"></time>L'utilisateur <strong data-bind="text: $data.user.name"></strong> a modifié les informations du compte
									</li>
									<!-- /ko -->
									<!-- ko if: $data.type == 3 -->
									<li>
										<time data-bind="attr: { 'datetime': $data.date }" class="timeago"></time>L'utilisateur <strong data-bind="text: $data.user.name"></strong> a suivi votre projet
									</li>
									<!-- /ko -->
									<!-- ko if: $data.type == 4 -->
									<li>
										<time data-bind="attr: { 'datetime': $data.date }" class="timeago"></time>L'utilisateur <strong data-bind="text: $data.user.name"></strong> ne suit plus votre projet
									</li>
									<!-- /ko -->
									<!-- ko if: $data.type == 5 -->
									<li>
										<time data-bind="attr: { 'datetime': $data.date }" class="timeago"></time>L'utilisateur <strong data-bind="text: $data.user.name"></strong> a partagé des nouvelles de votre projet
									</li>
									<!-- /ko -->
								<!-- /ko -->
								</ul>
							</section>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</section>
<!-- End Hero Section -->

<script src="{$host}assets/js/tinymce/tinymce.min.js"></script>
<script src="{$host}assets/js/jquery.simpleupload.js"></script>
<script type="text/javascript" src="{$host}resources/pages/js/project-edit.js"></script>

<script type="text/javascript">

	model.load("{$ref}");
	
	jQuery(document).ready(function($) {
		$('.slider').each(function() {
			var $this = $(this);
			$this.formslider({ speed: ($this.attr('data-slider-speed') || 500) * 1 });
		});
		
		$("#fileuploader").simpleupload({
			url: '{$host}api/image',
			acceptFiles:"image/*",
			previewImage: '#fileuploader-preview',
			authorizedExtensions:"png,jpg,jpeg",
			maxFileSize:3*1024*1024,
			onUploadProgress: function(file, e) {
				
				var percent = Math.round(e.loaded / e.total * 100 * 10) / 10; // round to 1 dec
				$('#fileupload-pbar').width(percent + '%');
				
			},
			onUploadComplete: function(file, status, data) {
				if(status == 200) {
					var json = JSON.parse(data);
					model.form.image(json.location);
				}
			}
		});
		
	});
	
</script>